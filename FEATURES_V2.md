# 新功能使用說明 - 第二版

本次更新實現了行事曆匯出與互動式編輯功能，讓資料管理更加靈活便利！

## ✅ 新增功能

### 4. 📅 行事曆匯入/匯出功能

**ICS 格式匯出：**
- 支援匯出課程表、打工班表、重要事件為 .ics 格式
- 可直接匯入 Google Calendar、Apple Calendar、Outlook 等行事曆應用
- 課程自動設定為每週重複（18週學期）
- 打工班表和事件以單次活動匯出

**使用方式：**
1. 點擊首頁右下角的「匯出 / 匯入」按鈕
2. 選擇要匯出的類型：
   - **課程表** - 僅匯出課程
   - **打工班表** - 僅匯出打工班表
   - **重要事件** - 僅匯出重要事件
   - **完整行程** - 匯出所有資料（推薦）
3. 下載 .ics 檔案
4. 在行事曆應用中選擇「匯入行事曆」
5. 選擇剛下載的 .ics 檔案即可

**支援的行事曆應用：**
- Google Calendar（網頁版、手機版）
- Apple Calendar（macOS、iOS）
- Microsoft Outlook
- 其他支援 iCalendar 格式的應用

---

### 5. 💾 備份與還原功能

**完整備份：**
- 備份所有資料（課程、打工班表、事件、主題設定）
- 以 JSON 格式儲存，可用文字編輯器查看
- 包含資料版本和匯出日期資訊

**還原功能：**
- 從備份檔案還原所有資料
- 自動驗證備份檔案格式
- 還原前會顯示備份資訊供確認

**使用方式：**

**備份資料：**
1. 點擊首頁右下角的「匯出 / 匯入」按鈕
2. 在「備份與還原」區塊點擊「下載備份檔」
3. 備份檔案會以 `schedule-backup-YYYY-MM-DD.json` 命名

**還原資料：**
1. 點擊首頁右下角的「匯出 / 匯入」按鈕
2. 在「備份與還原」區塊點擊「匯入備份檔」
3. 選擇之前下載的備份檔案
4. 確認備份資訊後點擊確定
5. 頁面會自動重新載入，顯示還原後的資料

**注意事項：**
- 還原備份會**覆蓋**目前的所有資料
- 建議在還原前先備份目前的資料
- 備份檔案可以用作跨裝置同步資料

---

### 6. 📊 CSV 匯出功能

**功能說明：**
- 將課程表或打工班表匯出為 CSV 格式
- 可用 Excel、Google Sheets 等試算表軟體開啟
- 適合列印或製作統計分析

**使用方式：**
1. 點擊首頁右下角的「匯出 / 匯入」按鈕
2. 在「匯出為 CSV」區塊選擇：
   - **課程表 CSV** - 匯出課程資料
   - **打工班表 CSV** - 匯出打工資料
3. 使用 Excel 或 Google Sheets 開啟下載的檔案

---

### 7. ✏️ 互動式編輯介面

**課程管理：**
- 新增、編輯、刪除課程
- 自訂課程顏色
- 支援週一至週日的課程安排
- 即時更新課表顯示

**打工班表管理：**
- 新增、編輯、刪除打工班表
- 按月分組顯示
- 快速複製上週或上月班表

**使用方式：**

**管理課程：**
1. 點擊導覽列的「管理」
2. 在「課程管理」分頁中：
   - 點擊「+ 新增課程」新增課程
   - 點擊課程卡片的「✏️」按鈕編輯
   - 點擊課程卡片的「🗑️」按鈕刪除
3. 在編輯視窗中填寫：
   - 課程名稱（必填）
   - 星期幾（必填）
   - 開始時間（必填）
   - 結束時間（必填）
   - 地點（選填）
   - 顏色（選填，預設為靛藍色）

**管理打工班表：**
1. 點擊導覽列的「管理」
2. 切換到「打工班表」分頁
3. 使用以下功能：
   - **+ 新增班表** - 新增單一班表
   - **📋 複製上週** - 自動複製上週的所有班表到本週
   - **📋 複製上月** - 自動複製上月的所有班表到本月
   - **✏️** - 編輯班表
   - **🗑️** - 刪除班表

---

### 8. 🔄 快速複製打工班表

**功能說明：**
- 一鍵複製上週或上月的打工班表
- 自動調整日期
- 節省重複輸入時間

**複製上週班表：**
1. 點擊「📋 複製上週」按鈕
2. 系統會自動找出上週（過去7天）的所有班表
3. 確認後，班表會自動複製到本週對應的日期
4. 例如：上週一的班表會複製到這週一

**複製上月班表：**
1. 點擊「📋 複製上月」按鈕
2. 系統會找出上個月的所有班表
3. 確認後，班表會複製到本月對應的日期
4. 例如：上月15日的班表會複製到本月15日
5. 如果本月沒有該日期（如2月30日），則會自動跳過

**使用情境：**
- 固定每週都有相同的打工時段
- 每月的班表大致相同，只需微調
- 批次新增班表，再個別修改特殊日期

---

## 🎯 完整功能清單

### 已實現功能（第一版）
1. ✅ LocalStorage 資料持久化
2. ✅ PWA 離線支援
3. ✅ 深色/淺色主題切換

### 已實現功能（第二版）
4. ✅ ICS 行事曆匯出
5. ✅ 備份與還原
6. ✅ CSV 匯出
7. ✅ 互動式課程編輯
8. ✅ 互動式打工班表編輯
9. ✅ 快速複製班表功能

---

## 📍 功能位置導覽

### 首頁
- 右下角浮動按鈕：「匯出 / 匯入」面板
  - 匯出 ICS 行事曆
  - 備份與還原
  - 匯出 CSV

### 管理頁面（導覽列「管理」）
- **課程管理**分頁
  - 新增/編輯/刪除課程
  - 查看所有課程列表
  
- **打工班表**分頁
  - 新增/編輯/刪除班表
  - 複製上週/上月班表
  - 按月分組顯示

---

## 💡 使用建議

### 資料管理最佳實踐
1. **定期備份**：建議每週備份一次資料
2. **多裝置同步**：使用備份檔案在不同裝置間同步
3. **行事曆整合**：匯出 ICS 到 Google Calendar，手機也能查看
4. **批次操作**：使用「複製上週」功能快速建立規律班表

### 資料安全
- 所有資料儲存在瀏覽器本地，不會上傳到伺服器
- 清除瀏覽器資料會導致資料遺失，請務必備份
- 備份檔案包含完整資料，妥善保管

### 效能優化
- 建議課程數量控制在 50 個以內
- 打工班表建議保留最近 3 個月的資料
- 定期清理過期的班表資料

---

## 🔧 技術資訊

### 新增檔案
**Utilities (工具函式)**
- `src/utils/icsExport.ts` - ICS 匯出功能
- `src/utils/backup.ts` - 備份與還原功能

**Components (元件)**
- `src/components/ExportImport.tsx` - 匯出/匯入管理面板
- `src/components/CourseEditor.tsx` - 課程編輯對話框
- `src/components/WorkShiftEditor.tsx` - 班表編輯對話框
- `src/components/CourseManager.tsx` - 課程管理元件
- `src/components/WorkShiftManager.tsx` - 班表管理元件

**Pages (頁面)**
- `src/app/manage/page.tsx` - 管理頁面

**Styles (樣式)**
- `src/components/ExportImport.module.css`
- `src/components/CourseEditor.module.css`
- `src/components/WorkShiftEditor.module.css`
- `src/components/CourseManager.module.css`
- `src/components/WorkShiftManager.module.css`
- `src/app/manage/page.module.css`

---

## 📚 相關資源

### ICS 格式說明
- [iCalendar 規範](https://icalendar.org/)
- [Google Calendar 匯入說明](https://support.google.com/calendar/answer/37118)

### 資料備份
- 備份檔案為標準 JSON 格式
- 可使用任何文字編輯器查看和編輯（進階用途）

---

祝使用愉快！如有問題或建議，歡迎回饋。🎉
