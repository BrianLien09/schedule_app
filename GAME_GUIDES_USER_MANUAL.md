# 🎮 遊戲攻略系統 - 使用指南

## ✨ 功能總覽

你的遊戲攻略頁面已經完成全面升級！新系統提供以下功能：

### 🎯 核心功能

1. **獨立資料庫架構**
   - 全新的 Firestore Collection：`/shared/data/gameGuides`
   - 完全隔離於課表、薪資等現有資料
   - 支援即時多人協作同步

2. **動態內容管理**
   - ✎ 編輯模式：直接在頁面上新增/修改/刪除攻略
   - 📋 豐富欄位：主題、副標、URL、共鳴譜代碼
   - 🏷️ 分類標籤：角色攻略、活動攻略、通用資源、角色養成、版本總覽
   - ⭐ 重要性：1-5 星評級系統
   - 🎯 自訂標籤：新手必看、速刷指南、配隊推薦等

3. **視覺化資訊層次**
   - 📊 進度條：即時顯示攻略完成度
   - 🎨 分類標籤：不同顏色區分攻略類型
   - ⭐ 星級顯示：一眼看出重要程度
   - ✓ 完成標記：已完成的攻略帶有視覺反饋
   - 🎮 遊戲/版本篩選：快速定位所需內容

---

## 🚀 快速開始

### 步驟 1：更新 Firestore 規則

1. 前往 [Firebase Console](https://console.firebase.google.com/)
2. 選擇你的專案
3. **Firestore Database** → **規則**
4. 參考 `FIRESTORE_RULES_GAME_GUIDES.md` 文件更新規則
5. **重要**：點擊「發布」按鈕使規則生效

### 步驟 2：執行資料遷移

1. 啟動開發伺服器：
   ```bash
   npm run dev
   ```

2. 登入你的 Google 帳號

3. 前往資料遷移頁面：
   ```
   http://localhost:3000/games/migration
   ```

4. 點擊「開始遷移」按鈕

5. 等待遷移完成（應該會看到成功訊息）

### 步驟 3：開始使用

前往攻略頁面：
```
http://localhost:3000/games
```

---

## 📚 功能使用說明

### 🎮 遊戲切換

頁面頂部的遊戲切換器可以切換不同遊戲（目前支援：重返未來1999、星穹鐵道）。

### 🔢 版本篩選

如果遊戲有版本分類（如 v3.1、v3.2），會顯示版本篩選器：
- 點擊「全部版本」查看所有攻略
- 點擊特定版本（如 v3.1）只顯示該版本攻略

### 📊 進度統計

進度總覽區塊會顯示：
- 當前篩選範圍的完成度百分比
- 已完成數量 / 總數量
- 動態漸層進度條

### ✎ 編輯模式

#### 開啟編輯模式
點擊右上角「✎ 編輯模式」按鈕

#### 新增攻略
1. 點擊「+ 新增攻略」按鈕
2. 填寫表單：
   - **攻略主題**（必填）：例如「艾莉絲角色攻略」
   - **副標題**（選填）：例如「輸出流配隊詳解」
   - **攻略連結**：完整的 URL
   - **共鳴譜代碼**：Base64 編碼的遊戲配置
   - **分類**：選擇攻略類型
   - **重要性**：點擊星星設定 1-5 星
   - **標籤**：點擊預設標籤或自訂標籤
3. 點擊「💾 儲存」

#### 修改攻略
1. 在編輯模式下，每張卡片會顯示「✎ 編輯」按鈕
2. 點擊後會展開編輯表單
3. 修改內容後點擊「💾 儲存」

#### 刪除攻略
1. 在編輯模式下，每張卡片會顯示「🗑️ 刪除」按鈕
2. 點擊後會彈出確認對話框
3. 確認後即刪除（無法復原）

### ✓ 完成標記

在一般模式（非編輯模式）下：
- 每張卡片右下角有 ○ 或 ✓ 按鈕
- 點擊可切換完成/未完成狀態
- 已完成的攻略會有半透明遮罩和「✓ 已完成」標記

### 🔗 查看攻略

- 點擊「查看攻略 →」按鈕會在新分頁開啟連結
- 點擊「📋 複製共鳴譜」會複製共鳴譜代碼到剪貼簿

---

## 🎨 視覺元素說明

### 分類顏色編碼

| 分類 | 顏色 | 說明 |
|------|------|------|
| 角色攻略 | 🔵 青色 | 特定角色的養成、配隊、玩法攻略 |
| 活動攻略 | 🟡 琥珀色 | 限時活動、節日活動相關 |
| 通用資源 | 🟢 翡翠色 | 官網、Wiki、工具網站等 |
| 角色養成 | 🟣 紫色 | 共鳴譜配置、技能升級路線 |
| 版本總覽 | 🟣 粉色 | 版本更新內容、新角色預告 |

### 星級意義

- ⭐ 1 星：參考用資訊
- ⭐⭐ 2 星：值得一看
- ⭐⭐⭐ 3 星：推薦閱讀（預設值）
- ⭐⭐⭐⭐ 4 星：重點攻略
- ⭐⭐⭐⭐⭐ 5 星：必看內容

### 進度條顏色

進度條使用動態漸層：
- 青色 → 翡翠色（`var(--color-accent)` → `var(--color-primary)`）
- 完成度越高，視覺上越有成就感

---

## 📂 檔案結構

新增的檔案：

```
src/
├── data/
│   └── gameGuides.ts                    # 資料型別定義與常數
├── hooks/
│   └── useGameGuides.ts                 # 攻略資料管理 Hook
├── services/
│   └── firestoreService.ts              # 新增 gameGuides CRUD 方法
├── components/
│   ├── GuideComponents.tsx              # 視覺化元件（卡片、標籤、星級、進度條）
│   ├── GuideComponents.module.css       # 視覺化元件樣式
│   ├── GuideEditForm.tsx                # 編輯表單元件
│   └── GuideEditForm.module.css         # 編輯表單樣式
├── app/
│   └── games/
│       ├── page.tsx                     # 主攻略頁面（完全重構）
│       ├── page.module.css              # 主頁面樣式
│       └── migration/
│           ├── page.tsx                 # 資料遷移工具
│           └── migration.module.css     # 遷移工具樣式
└── FIRESTORE_RULES_GAME_GUIDES.md       # Firestore 規則設定指南
```

---

## 🔧 技術架構

### 資料流

```
Firestore (/shared/data/gameGuides)
    ↓
subscribeToGameGuides (即時監聽)
    ↓
useGameGuides Hook (狀態管理 + CRUD 方法)
    ↓
GamesPage (主頁面元件)
    ↓
├── GuideCard (攻略卡片)
│   ├── CategoryBadge (分類標籤)
│   ├── StarRating (星級顯示)
│   ├── TagList (標籤列表)
│   └── CompletedOverlay (完成遮罩)
└── GuideEditForm (編輯表單)
    └── StarRating (互動式星級選擇)
```

### 資料結構

```typescript
interface GameGuide {
  id: string;
  gameId: string;              // 所屬遊戲 ID
  version?: string;             // 所屬版本（選填）
  title: string;                // 攻略主題
  subtitle?: string;            // 副標題
  url: string;                  // 攻略連結
  resonanceCode?: string;       // 共鳴譜代碼
  category: GuideCategory;      // 分類
  priority: number;             // 1-5 星
  tags: string[];               // 自訂標籤
  completed: boolean;           // 完成狀態
  order: number;                // 排序順序
  createdAt: string;            // 建立時間
  updatedAt: string;            // 更新時間
}
```

---

## 🎯 使用建議

### 資料組織建議

1. **通用資源**：放在遊戲層級（不指定版本）
   - 官方網站
   - 社群 Discord
   - 大神主頁

2. **版本專屬內容**：標記版本號
   - v3.1 角色攻略
   - v3.2 活動攻略

3. **星級評分參考**
   - 5 星：版本強勢角色攻略、重大活動攻略
   - 4 星：實用工具、資源規劃指南
   - 3 星：一般角色攻略、常規攻略
   - 2 星：補充資訊
   - 1 星：存檔用連結

4. **標籤使用建議**
   - 新手必看：適合新玩家的入門攻略
   - 速刷指南：高效率養成路線
   - 配隊推薦：陣容搭配建議
   - 機制解析：深度遊戲機制分析
   - 資源規劃：資源分配策略

### 進度追蹤建議

- 定期標記已完成的攻略
- 使用進度條檢視整體學習進度
- 未完成的攻略優先顯示在上方（可透過排序實現）

---

## 🐛 故障排除

### 問題 1：看不到攻略資料

**可能原因**：
- 尚未執行資料遷移
- Firestore 規則未更新
- 未登入或登入帳號不在白名單

**解決方案**：
1. 確認已登入（右上角顯示你的 Google 頭像）
2. 前往 `/games/migration` 執行遷移
3. 檢查 Firestore 規則是否已發布

### 問題 2：編輯功能無法使用

**錯誤訊息**：`Missing or insufficient permissions`

**解決方案**：
1. 確認 Firestore 規則中的白名單包含你的 Email
2. 重新登入
3. 清除瀏覽器快取

### 問題 3：進度條不正確

**可能原因**：
- 完成狀態未正確更新

**解決方案**：
- 重新整理頁面
- 檢查 Firestore Console 中的實際資料

### 問題 4：卡片樣式異常

**可能原因**：
- CSS 變數未正確載入

**解決方案**：
- 確認 `globals.css` 中的 CSS 變數正確設定
- 檢查主題切換功能是否正常

---

## 🚀 未來擴充方向

以下功能可在未來考慮加入：

1. **個人化進度追蹤**
   - 每個人各自的完成記錄
   - 需要調整資料結構為 Map 類型

2. **圖片上傳功能**
   - 整合 Firebase Storage
   - 上傳攻略封面圖、角色立繪

3. **拖拽排序**
   - 手動調整攻略卡片順序
   - 使用 react-beautiful-dnd 等函式庫

4. **搜尋功能**
   - 全文搜尋標題/副標
   - 標籤篩選
   - 模糊搜尋

5. **匯出功能**
   - 匯出為 Markdown
   - 匯出為 PDF
   - 列印友善格式

6. **評論系統**
   - 在攻略下方加入評論
   - 團隊成員可交流心得

7. **歷史記錄**
   - 記錄每次修改
   - 可回溯先前版本

---

## 📝 注意事項

1. **資料備份**
   - 建議啟用 Firestore 自動備份功能
   - 定期檢查資料完整性

2. **權限管理**
   - 定期檢查白名單成員
   - 移除不再需要存取權限的成員

3. **資料配額**
   - Firebase 免費方案有讀寫次數限制
   - 監控每日使用量

4. **安全性**
   - 使用強密碼保護 Google 帳號
   - 啟用兩步驟驗證

---

## 🎉 完成！

你的遊戲攻略系統已經全面升級完成！

現在可以：
✅ 動態管理攻略內容
✅ 視覺化追蹤學習進度
✅ 團隊協作即時同步
✅ 支援多遊戲/多版本分類

如有任何問題或需要協助，請參考本文件或檢查 Browser Console 的錯誤訊息。

祝你使用愉快！🎮✨
