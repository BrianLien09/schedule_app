(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,8437,e=>{e.v({card:"LoginPrompt-module__ERCXna__card",container:"LoginPrompt-module__ERCXna__container",description:"LoginPrompt-module__ERCXna__description",footer:"LoginPrompt-module__ERCXna__footer",googleIcon:"LoginPrompt-module__ERCXna__googleIcon",icon:"LoginPrompt-module__ERCXna__icon",iconWrapper:"LoginPrompt-module__ERCXna__iconWrapper",loginButton:"LoginPrompt-module__ERCXna__loginButton",title:"LoginPrompt-module__ERCXna__title"})},93475,19119,24558,34759,e=>{"use strict";var t=e.i(71645),a=e.i(32341);let i=[{id:"mon-1",name:"職涯分析與規劃",day:1,startTime:"08:10",endTime:"10:00",location:"博愛CB105D",color:"#fca5a5"},{id:"mon-2",name:"國文(II)：語文表達",day:1,startTime:"10:10",endTime:"12:00",location:"博愛C306",color:"#fda4af"},{id:"mon-3",name:"數位電子學",day:1,startTime:"13:10",endTime:"16:00",location:"博愛G313",color:"var(--color-primary)"},{id:"tue-1",name:"網際網路概論",day:2,startTime:"08:10",endTime:"10:00",location:"博愛G512電腦教室",color:"#fdba74"},{id:"tue-2",name:"大學生活學習與輔導",day:2,startTime:"13:10",endTime:"15:00",location:"博愛G313",color:"var(--color-highlight)"},{id:"wed-1",name:"英文(II)",day:3,startTime:"08:10",endTime:"10:00",location:"博愛C608",color:"#86efac"},{id:"wed-2",name:"羽球",day:3,startTime:"10:10",endTime:"12:00",location:"博愛公誠樓籃球場",color:"#bef264"},{id:"wed-3",name:"資料結構",day:3,startTime:"15:10",endTime:"18:00",location:"博愛G513電腦教室",color:"var(--color-secondary)"},{id:"fri-1",name:"民歌與吉他",day:5,startTime:"08:10",endTime:"10:00",location:"博愛M304",color:"#93c5fd"},{id:"fri-2",name:"Python資料視覺化",day:5,startTime:"10:10",endTime:"12:00",location:"博愛G521電腦教室",color:"#c4b5fd"},{id:"fri-3",name:"C程式設計",day:5,startTime:"13:10",endTime:"16:00",location:"博愛G512電腦教室",color:"#a78bfa"}],n=[{id:"aut-1",date:"2026-01-11",startTime:"09:00",endTime:"18:00",note:"秋季班"},{id:"aut-2",date:"2026-01-17",startTime:"09:00",endTime:"18:00",note:"秋季班"},{id:"aut-3",date:"2026-01-18",startTime:"09:00",endTime:"18:00",note:"秋季班"},{id:"win-1",date:"2026-01-27",startTime:"09:00",endTime:"18:00",note:"冬令營助教"},{id:"win-2",date:"2026-01-29",startTime:"09:00",endTime:"18:00",note:"冬令營助教"},{id:"win-3",date:"2026-02-02",startTime:"09:00",endTime:"18:00",note:"冬令營助教"},{id:"win-4",date:"2026-02-04",startTime:"09:00",endTime:"18:00",note:"冬令營助教"},{id:"win-5",date:"2026-02-05",startTime:"09:00",endTime:"18:00",note:"冬令營助教"},{id:"win-6",date:"2026-02-06",startTime:"09:00",endTime:"18:00",note:"冬令營助教"},{id:"win-7",date:"2026-02-09",startTime:"09:00",endTime:"18:00",note:"冬令營助教"},{id:"win-8",date:"2026-02-10",startTime:"09:00",endTime:"18:00",note:"冬令營助教"},{id:"win-9",date:"2026-02-11",startTime:"09:00",endTime:"18:00",note:"冬令營助教"},{id:"win-10",date:"2026-02-13",startTime:"09:00",endTime:"18:00",note:"冬令營助教"}],d=[{id:"sel-1",title:"志願序結果查詢 & 本班選課",date:"2026-01-05",description:"09:00 查詢結果 / 19:00 開始選課",type:"deadline"},{id:"sel-2",title:"本系選課 (含輔雙)",date:"2026-01-06",description:"19:00 開始",type:"deadline"},{id:"sel-3",title:"跨系/跨班選課",date:"2026-01-08",description:"19:00 開始",type:"deadline"},{id:"sel-4",title:"全校網路加退選",date:"2026-02-23",description:"上午 10:00 開始",type:"deadline"},{id:"sel-5",title:"人工加退選",date:"2026-03-02",description:"上午 09:00 開始",type:"personal"}];e.i(36180);var r=e.i(98925),l=e.i(59141);function o(e,t){if(!l.isFirebaseConfigured||!l.db)throw Error("Firebase 未設定，請檢查環境變數");return(0,r.collection)(l.db,"shared","data",t)}async function s(e,t,a,i){if(!l.isFirebaseConfigured||!l.db)throw Error("Firebase 未設定，請檢查環境變數");let n=(0,r.doc)(l.db,"shared","data",t,a);await (0,r.setDoc)(n,{...i,updatedAt:new Date().toISOString()})}async function c(e,t,...a){let i=o(e,t),n=a.length>0?(0,r.query)(i,...a):i;return(await (0,r.getDocs)(n)).docs.map(e=>({id:e.id,...e.data()}))}async function u(e,t,a,i){if(!l.isFirebaseConfigured||!l.db)throw Error("Firebase 未設定，請檢查環境變數");let n=(0,r.doc)(l.db,"shared","data",t,a);await (0,r.updateDoc)(n,{...i,updatedAt:new Date().toISOString()})}async function m(e,t,a){if(!l.isFirebaseConfigured||!l.db)throw Error("Firebase 未設定，請檢查環境變數");let i=(0,r.doc)(l.db,"shared","data",t,a);await (0,r.deleteDoc)(i)}function h(e,t,a,...i){let n=o(e,t),d=i.length>0?(0,r.query)(n,...i):n;return(0,r.onSnapshot)(d,e=>{a(e.docs.map(e=>({id:e.id,...e.data()})))})}async function f(e,t,a){let i=a.map(a=>{let{id:i,...n}=a;return s(e,t,i,n)});await Promise.all(i)}function _(e){return!!e}e.s(["batchSetDocuments",()=>f,"deleteDocument",()=>m,"getDocuments",()=>c,"setDocument",()=>s,"subscribeToCollection",()=>h,"updateDocument",()=>u],19119),e.s(["hasWriteAccess",()=>_],24558);let g="shared";function p(){let{user:e}=(0,a.useAuth)(),[r,l]=(0,t.useState)([]),[o,_]=(0,t.useState)([]),[p,w]=(0,t.useState)([]),[y,C]=(0,t.useState)(!0),[T,b]=(0,t.useState)(!1),v=async()=>{try{let e=await c(g,"courses"),t=await c(g,"workShifts"),a=await c(g,"events");0===e.length&&await f(g,"courses",i),0===t.length&&await f(g,"workShifts",n),0===a.length&&await f(g,"events",d)}catch(e){console.error("❌ 初始化預設資料失敗:",e)}};(0,t.useEffect)(()=>{if(!e){l([]),_([]),w([]),C(!1),b(!1);return}C(!0),b(!!e.email),v().then(()=>{C(!1)});let t=h(g,"courses",e=>l(e)),a=h(g,"workShifts",e=>_(e)),i=h(g,"events",e=>w(e));return()=>{t(),a(),i()}},[e]);let S=async t=>{e&&T?await s(g,"courses",t.id,t):console.warn("❌ 無編輯權限")},N=async(t,a)=>{e&&T?await u(g,"courses",t,a):console.warn("❌ 無編輯權限")},x=async t=>{e&&T?await m(g,"courses",t):console.warn("❌ 無編輯權限")},M=async t=>{e&&T?await s(g,"workShifts",t.id,t):console.warn("❌ 無編輯權限")},j=async(t,a)=>{e&&T?await u(g,"workShifts",t,a):console.warn("❌ 無編輯權限")},D=async t=>{e&&T?await m(g,"workShifts",t):console.warn("❌ 無編輯權限")},K=async t=>{e&&T?await s(g,"events",t.id,t):console.warn("❌ 無編輯權限")},k=async(t,a)=>{e&&T?await u(g,"events",t,a):console.warn("❌ 無編輯權限")},E=async t=>{e&&T?await m(g,"events",t):console.warn("❌ 無編輯權限")};return{courses:r,shifts:o,events:p,loading:y,canEdit:T,addCourse:S,updateCourse:N,deleteCourse:x,addWorkShift:M,updateWorkShift:j,deleteWorkShift:D,addEvent:K,updateEvent:k,deleteEvent:E}}e.s(["useScheduleData",()=>p],93475);var w=e.i(43476),y=e.i(8437);function C(){let{signInWithGoogle:e}=(0,a.useAuth)(),t=async()=>{try{await e()}catch(e){console.error("登入失敗:",e),alert("登入失敗，請稍後再試")}};return(0,w.jsx)("div",{className:y.default.container,children:(0,w.jsxs)("div",{className:y.default.card,children:[(0,w.jsx)("div",{className:y.default.iconWrapper,children:(0,w.jsx)("svg",{className:y.default.icon,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,w.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,w.jsx)("h2",{className:y.default.title,children:"需要登入"}),(0,w.jsx)("p",{className:y.default.description,children:"請先使用 Google 帳號登入，才能查看課表資料"}),(0,w.jsxs)("button",{onClick:t,className:y.default.loginButton,children:[(0,w.jsxs)("svg",{className:y.default.googleIcon,viewBox:"0 0 24 24",children:[(0,w.jsx)("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,w.jsx)("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,w.jsx)("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,w.jsx)("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"使用 Google 登入"]}),(0,w.jsx)("p",{className:y.default.footer,children:"僅限授權的家庭成員登入"})]})})}e.s(["default",()=>C],34759)},21163,e=>{e.v({calendarContainer:"page-module__wKMnra__calendarContainer",dayCell:"page-module__wKMnra__dayCell",dayCellEmpty:"page-module__wKMnra__dayCellEmpty",dayCellWithShift:"page-module__wKMnra__dayCellWithShift",dayNumber:"page-module__wKMnra__dayNumber",dayNumberEmpty:"page-module__wKMnra__dayNumberEmpty",dayNumberWithShift:"page-module__wKMnra__dayNumberWithShift",daysGrid:"page-module__wKMnra__daysGrid",detailsSection:"page-module__wKMnra__detailsSection",emptyCell:"page-module__wKMnra__emptyCell",pageContainer:"page-module__wKMnra__pageContainer",sectionTitle:"page-module__wKMnra__sectionTitle",shiftBadge:"page-module__wKMnra__shiftBadge",shiftCard:"page-module__wKMnra__shiftCard",shiftCardNormal:"page-module__wKMnra__shiftCardNormal",shiftCardSelected:"page-module__wKMnra__shiftCardSelected",shiftDate:"page-module__wKMnra__shiftDate",shiftDetails:"page-module__wKMnra__shiftDetails",shiftName:"page-module__wKMnra__shiftName",shiftTime:"page-module__wKMnra__shiftTime",shiftsGrid:"page-module__wKMnra__shiftsGrid",weekdayLabel:"page-module__wKMnra__weekdayLabel",weekdaysGrid:"page-module__wKMnra__weekdaysGrid"})},45858,e=>{"use strict";var t=e.i(43476),a=e.i(71645),i=e.i(93475),n=e.i(32341),d=e.i(34759),r=e.i(21163);function l(){let{user:e,loading:l}=(0,n.useAuth)(),{shifts:o}=(0,i.useScheduleData)(),{currentMonth:s,selectedDate:c,changeMonth:u,getDaysInMonth:m,getShiftsForDate:h,currentMonthShifts:f,handleDateClick:_}=function(e){let[t,i]=(0,a.useState)(new Date),[n,d]=(0,a.useState)(null),r=(0,a.useRef)(null),l=(0,a.useMemo)(()=>{let t=new Map;return e.forEach(e=>{t.has(e.date)||t.set(e.date,[]),t.get(e.date).push(e)}),t},[e]),o=(0,a.useMemo)(()=>e.filter(e=>{let a=new Date(e.date);return a.getMonth()===t.getMonth()&&a.getFullYear()===t.getFullYear()}).sort((e,t)=>e.date.localeCompare(t.date)),[t,e]);return(0,a.useEffect)(()=>{if(r.current){let e=document.querySelector(`[data-date="${r.current}"]`);e&&e.scrollIntoView({behavior:"smooth",block:"center"}),r.current=null}},[n]),{currentMonth:t,selectedDate:n,changeMonth:e=>{i(new Date(t.getFullYear(),t.getMonth()+e,1))},getDaysInMonth:e=>{let t=e.getFullYear(),a=e.getMonth(),i=new Date(t,a+1,0).getDate(),n=new Date(t,a,1).getDay();return{days:i,startDay:0===n?6:n-1}},getShiftsForDate:e=>{let a=t.getFullYear(),i=t.getMonth()+1,n=`${a}-${i.toString().padStart(2,"0")}-${e.toString().padStart(2,"0")}`;return l.get(n)||[]},currentMonthShifts:o,handleDateClick:e=>{let a=t.getFullYear(),i=t.getMonth()+1,n=`${a}-${i.toString().padStart(2,"0")}-${e.toString().padStart(2,"0")}`;d(n),r.current=n}}}(o),{days:g,startDay:p}=m(s);return l?(0,t.jsx)("div",{style:{padding:"2rem",textAlign:"center"},children:"載入中..."}):e?(0,t.jsx)("div",{className:r.default.pageContainer,children:(0,t.jsx)("div",{className:`glass ${r.default.calendarContainer}`,children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"calendar-header",children:[(0,t.jsx)("button",{onClick:()=>u(-1),className:"btn",style:{background:"rgba(255,255,255,0.3)",color:"white"},children:"← 上個月"}),(0,t.jsxs)("h2",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:[s.getFullYear()," 年 ",s.getMonth()+1," 月"]}),(0,t.jsx)("button",{onClick:()=>u(1),className:"btn",style:{background:"rgba(255,255,255,0.3)",color:"white"},children:"下個月 →"})]}),(0,t.jsx)("div",{className:r.default.weekdaysGrid,children:["一","二","三","四","五","六","日"].map(e=>(0,t.jsx)("div",{className:r.default.weekdayLabel,children:e},e))}),(0,t.jsxs)("div",{className:r.default.daysGrid,children:[Array.from({length:p}).map((e,a)=>(0,t.jsx)("div",{className:r.default.emptyCell},`empty-${a}`)),Array.from({length:g}).map((e,a)=>{let i=a+1,n=h(i),d=n.length>0;return(0,t.jsxs)("div",{onClick:()=>d&&_(i),className:`${r.default.dayCell} ${d?r.default.dayCellWithShift:r.default.dayCellEmpty} ${d?"card":""}`,children:[(0,t.jsx)("div",{className:`${r.default.dayNumber} ${d?r.default.dayNumberWithShift:r.default.dayNumberEmpty}`,children:i}),n.map(e=>(0,t.jsx)("div",{className:r.default.shiftBadge,children:e.note||"打工"},e.id))]},i)})]}),(0,t.jsxs)("div",{className:r.default.detailsSection,children:[(0,t.jsx)("h3",{className:r.default.sectionTitle,children:"本月詳細列表"}),(0,t.jsx)("div",{className:r.default.shiftsGrid,children:f.map(e=>{let a=c===e.date;return(0,t.jsxs)("div",{"data-date":e.date,className:`${r.default.shiftCard} ${a?r.default.shiftCardSelected:r.default.shiftCardNormal}`,children:[(0,t.jsxs)("div",{className:r.default.shiftDate,children:[e.date.split("-")[2],"日"]}),(0,t.jsxs)("div",{className:r.default.shiftDetails,children:[(0,t.jsx)("div",{className:r.default.shiftName,children:e.note}),(0,t.jsxs)("div",{className:r.default.shiftTime,children:[e.startTime," - ",e.endTime]})]})]},e.id)})})]})]})})}):(0,t.jsx)(d.default,{})}e.s(["default",()=>l],45858)}]);