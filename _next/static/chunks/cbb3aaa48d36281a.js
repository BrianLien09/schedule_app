(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,19119,e=>{"use strict";e.i(36180);var a=e.i(98925),l=e.i(59141);function t(e){let a={};for(let[l,t]of Object.entries(e))void 0!==t&&(a[l]=t);return a}function n(e,t){if(!l.isFirebaseConfigured||!l.db)throw Error("Firebase æœªè¨­å®šï¼Œè«‹æª¢æŸ¥ç’°å¢ƒè®Šæ•¸");return(0,a.collection)(l.db,"shared","data",t)}async function o(e,l,o){let r=n(e,l),s=t({...o,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()});return(await (0,a.addDoc)(r,s)).id}async function r(e,n,o,r){if(!l.isFirebaseConfigured||!l.db)throw Error("Firebase æœªè¨­å®šï¼Œè«‹æª¢æŸ¥ç’°å¢ƒè®Šæ•¸");let s=(0,a.doc)(l.db,"shared","data",n,o),c=t({...r,updatedAt:new Date().toISOString()});await (0,a.setDoc)(s,c)}async function s(e,l,...t){let o=n(e,l),r=t.length>0?(0,a.query)(o,...t):o;return(await (0,a.getDocs)(r)).docs.map(e=>({id:e.id,...e.data()}))}async function c(e,n,o,r){if(!l.isFirebaseConfigured||!l.db)throw Error("Firebase æœªè¨­å®šï¼Œè«‹æª¢æŸ¥ç’°å¢ƒè®Šæ•¸");let s=(0,a.doc)(l.db,"shared","data",n,o),c=t({...r,updatedAt:new Date().toISOString()});await (0,a.updateDoc)(s,c)}async function d(e,t,n){if(!l.isFirebaseConfigured||!l.db)throw Error("Firebase æœªè¨­å®šï¼Œè«‹æª¢æŸ¥ç’°å¢ƒè®Šæ•¸");let o=(0,a.doc)(l.db,"shared","data",t,n);await (0,a.deleteDoc)(o)}function i(e,l,t,...o){let r=n(e,l),s=o.length>0?(0,a.query)(r,...o):r;return(0,a.onSnapshot)(s,e=>{t(e.docs.map(e=>({id:e.id,...e.data()})))})}async function u(e,a,l){let t=l.map(l=>{let{id:t,...n}=l;return r(e,a,t,n)});await Promise.all(t)}function m(e){return i("shared","gameGuides",e,(0,a.orderBy)("order","asc"))}async function g(e){return o("shared","gameGuides",e)}async function p(e,a){return c("shared","gameGuides",e,a)}async function _(e){return d("shared","gameGuides",e)}async function f(e){let a=e.map(e=>g(e));await Promise.all(a)}function h(e){return i("shared","courseNotes",e,(0,a.orderBy)("createdAt","desc"))}function x(e,l){return i("shared","courseNotes",l,(0,a.where)("courseId","==",e),(0,a.orderBy)("createdAt","desc"))}async function b(e){return o("shared","courseNotes",e)}async function v(e,a){return c("shared","courseNotes",e,a)}async function S(e){return d("shared","courseNotes",e)}async function j(e,a){return v(e,{completed:a})}async function y(){return(await s("shared","courseNotes",(0,a.where)("completed","==",!1),(0,a.where)("type","in",["homework","exam"]))).filter(e=>e.dueDate).sort((e,a)=>e.dueDate&&a.dueDate?new Date(e.dueDate).getTime()-new Date(a.dueDate).getTime():0)}e.s(["addCourseNote",()=>b,"addGameGuide",()=>g,"batchImportGameGuides",()=>f,"batchSetDocuments",()=>u,"deleteCourseNote",()=>S,"deleteDocument",()=>d,"deleteGameGuide",()=>_,"getDocuments",()=>s,"getIncompleteTasks",()=>y,"setDocument",()=>r,"subscribeToCollection",()=>i,"subscribeToCourseNotes",()=>h,"subscribeToCourseNotesByCourse",()=>x,"subscribeToGameGuides",()=>m,"toggleCourseNoteCompletion",()=>j,"updateCourseNote",()=>v,"updateDocument",()=>c,"updateGameGuide",()=>p])},8437,e=>{e.v({card:"LoginPrompt-module__ERCXna__card",container:"LoginPrompt-module__ERCXna__container",description:"LoginPrompt-module__ERCXna__description",footer:"LoginPrompt-module__ERCXna__footer",googleIcon:"LoginPrompt-module__ERCXna__googleIcon",icon:"LoginPrompt-module__ERCXna__icon",iconWrapper:"LoginPrompt-module__ERCXna__iconWrapper",loginButton:"LoginPrompt-module__ERCXna__loginButton",title:"LoginPrompt-module__ERCXna__title"})},24558,34759,e=>{"use strict";function a(e){return!!e}e.s(["hasWriteAccess",()=>a],24558);var l=e.i(43476),t=e.i(32341),n=e.i(8437);function o(){let{signInWithGoogle:e}=(0,t.useAuth)(),a=async()=>{try{await e()}catch(e){console.error("ç™»å…¥å¤±æ•—:",e),alert("ç™»å…¥å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦")}};return(0,l.jsx)("div",{className:n.default.container,children:(0,l.jsxs)("div",{className:n.default.card,children:[(0,l.jsx)("div",{className:n.default.iconWrapper,children:(0,l.jsx)("svg",{className:n.default.icon,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,l.jsx)("h2",{className:n.default.title,children:"éœ€è¦ç™»å…¥"}),(0,l.jsx)("p",{className:n.default.description,children:"è«‹å…ˆä½¿ç”¨ Google å¸³è™Ÿç™»å…¥ï¼Œæ‰èƒ½æŸ¥çœ‹èª²è¡¨è³‡æ–™"}),(0,l.jsxs)("button",{onClick:a,className:n.default.loginButton,children:[(0,l.jsxs)("svg",{className:n.default.googleIcon,viewBox:"0 0 24 24",children:[(0,l.jsx)("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,l.jsx)("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,l.jsx)("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,l.jsx)("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"ä½¿ç”¨ Google ç™»å…¥"]}),(0,l.jsx)("p",{className:n.default.footer,children:"åƒ…é™æˆæ¬Šçš„å®¶åº­æˆå“¡ç™»å…¥"})]})})}e.s(["default",()=>o],34759)},2502,89598,e=>{"use strict";var a=e.i(71645),l=e.i(32341),t=e.i(19119),n=e.i(24558);let o=["æ‰“å·¥æ”¶å…¥","ç”Ÿæ´»è²»åŒ¯æ¬¾","çå­¸é‡‘","é€€è²»","å…¶ä»–"];function r(){return`allowance-${Date.now()}`}function s(e,a){return e-a}function c(e){let[a,l,t]=e.split("-");return`${a}/${parseInt(l)}/${parseInt(t)}`}function d(e){if("ç”Ÿæ´»è²»åŒ¯æ¬¾"!==e.sourceType)return`åŒ¯å…¥æ—¥æœŸ: ${c(e.date)}
åŒ¯å…¥é‡‘é¡: ${e.amount}
ä¾†æº: ${e.sourceType}
å¸³ç°¿é¤˜é¡: ${e.totalBalance}
å°å‘†é¤˜é¡: ${e.xiaoBalance}`;{let a=e.totalBalance-e.xiaoBalance;return`åŒ¯å…¥æ—¥æœŸ: ${c(e.date)}
åŒ¯å…¥é‡‘é¡: ${e.amount}
å¸³ç°¿é¤˜é¡: ${e.totalBalance}
å­”å‘†é¤˜é¡: ${a}
å°å‘†é¤˜é¡: ${e.xiaoBalance}`}}e.s(["DEFAULT_SOURCE_TYPES",0,o,"calculateKongBalance",()=>s,"formatDateForCopy",()=>c,"generateAllowanceId",()=>r,"generateCopyText",()=>d],89598);let i="shared",u="allowanceRecords",m="allowanceSourceTypes";function g(){let{user:e}=(0,l.useAuth)(),[r,s]=(0,a.useState)([]),[c,d]=(0,a.useState)(o),[g,p]=(0,a.useState)(!0),[_,f]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!e){s([]),d(o),p(!1),f(!1);return}p(!0),f((0,n.hasWriteAccess)(e.email));let a=(0,t.subscribeToCollection)(i,u,e=>{s(e.sort((e,a)=>a.timestamp-e.timestamp)),p(!1)}),l=(0,t.subscribeToCollection)(i,m,e=>{e.length>0&&e[0].types&&d(e[0].types)});return()=>{a(),l()}},[e]);let h=async a=>{e&&_?await (0,t.setDocument)(i,u,a.id,a):console.warn("âŒ ç„¡ç·¨è¼¯æ¬Šé™")},x=async(a,l)=>{e&&_?await (0,t.updateDocument)(i,u,a,l):console.warn("âŒ ç„¡ç·¨è¼¯æ¬Šé™")},b=async a=>{e&&_?await (0,t.deleteDocument)(i,u,a):console.warn("âŒ ç„¡ç·¨è¼¯æ¬Šé™")},v=async a=>{if(!e||!_)return void console.warn("âŒ ç„¡ç·¨è¼¯æ¬Šé™");if(c.includes(a))return void console.warn("âš ï¸ ä¾†æºé¡å‹å·²å­˜åœ¨");let l=[...c,a];d(l),await (0,t.setDocument)(i,m,"config",{id:"config",types:l})},S=async a=>{if(!e||!_)return void console.warn("âŒ ç„¡ç·¨è¼¯æ¬Šé™");if(o.includes(a))return void console.warn("âš ï¸ ç„¡æ³•åˆªé™¤é è¨­ä¾†æºé¡å‹");let l=c.filter(e=>e!==a);d(l),await (0,t.setDocument)(i,m,"config",{id:"config",types:l})};return{records:r,sourceTypes:c,loading:g,canEdit:_,addRecord:h,updateRecord:x,deleteRecord:b,addSourceType:v,deleteSourceType:S}}e.s(["useAllowanceData",()=>g],2502)},74777,e=>{"use strict";var a=e.i(43476);e.s(["StatCard",0,({icon:e,label:l,value:t,subtext:n,color:o})=>(0,a.jsxs)("div",{className:"glass card",style:{padding:"var(--spacing-md)",textAlign:"center",borderTop:`3px solid ${o}`,transition:"all 300ms ease",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,a.jsx)("div",{style:{color:o,marginBottom:"var(--spacing-sm)",display:"flex",justifyContent:"center"},children:e}),(0,a.jsx)("div",{style:{fontSize:"1rem",color:"var(--muted)",marginBottom:"var(--spacing-xs)",fontWeight:"bold"},children:l}),(0,a.jsx)("div",{style:{fontSize:"2.5rem",fontWeight:"bold",marginBottom:"var(--spacing-xs)",color:"var(--foreground)"},children:t}),n&&(0,a.jsx)("div",{style:{fontSize:"0.9rem",color:"var(--foreground)",opacity:.8},children:n})]}),"TimelineItem",0,({time:e,title:l,location:t,isActive:n,isPast:o})=>(0,a.jsxs)("div",{style:{display:"flex",gap:"var(--spacing-md)",opacity:o?.5:1,position:"relative",paddingLeft:"var(--spacing-lg)"},children:[(0,a.jsx)("div",{style:{position:"absolute",left:"8px",top:0,bottom:0,width:"2px",background:n?"var(--color-primary)":"rgba(255, 255, 255, 0.1)"}}),(0,a.jsx)("div",{style:{position:"absolute",left:"2px",top:"8px",width:"14px",height:"14px",borderRadius:"50%",background:n?"var(--color-primary)":o?"var(--muted-dark)":"var(--glass-border)",border:`2px solid ${n?"var(--color-primary)":"var(--glass-border)"}`,boxShadow:n?"0 0 12px var(--color-primary)":"none"}}),(0,a.jsxs)("div",{style:{flex:1,paddingLeft:"var(--spacing-md)"},children:[(0,a.jsx)("div",{style:{fontSize:"0.85rem",color:"var(--muted)",marginBottom:"var(--spacing-xs)"},children:e}),(0,a.jsx)("div",{style:{fontWeight:600,marginBottom:"var(--spacing-xs)"},children:l}),t&&(0,a.jsxs)("div",{style:{fontSize:"0.85rem",color:"var(--muted-dark)"},children:["ğŸ“ ",t]})]})]})])},93716,e=>{e.v({active:"AllowanceManager-module__SDpZgW__active",addButton:"AllowanceManager-module__SDpZgW__addButton",amountLabel:"AllowanceManager-module__SDpZgW__amountLabel",amountSection:"AllowanceManager-module__SDpZgW__amountSection",amountValue:"AllowanceManager-module__SDpZgW__amountValue",autoCalcHint:"AllowanceManager-module__SDpZgW__autoCalcHint",balanceGrid:"AllowanceManager-module__SDpZgW__balanceGrid",balanceItem:"AllowanceManager-module__SDpZgW__balanceItem",balanceLabel:"AllowanceManager-module__SDpZgW__balanceLabel",balanceValue:"AllowanceManager-module__SDpZgW__balanceValue",btn:"AllowanceManager-module__SDpZgW__btn",btnDelete:"AllowanceManager-module__SDpZgW__btnDelete",btnEdit:"AllowanceManager-module__SDpZgW__btnEdit",btnPrimary:"AllowanceManager-module__SDpZgW__btnPrimary",btnSecondary:"AllowanceManager-module__SDpZgW__btnSecondary",closeButton:"AllowanceManager-module__SDpZgW__closeButton",container:"AllowanceManager-module__SDpZgW__container",copied:"AllowanceManager-module__SDpZgW__copied",copyButton:"AllowanceManager-module__SDpZgW__copyButton",emptyState:"AllowanceManager-module__SDpZgW__emptyState",emptyStateIcon:"AllowanceManager-module__SDpZgW__emptyStateIcon",emptyStateSubtitle:"AllowanceManager-module__SDpZgW__emptyStateSubtitle",emptyStateTitle:"AllowanceManager-module__SDpZgW__emptyStateTitle",expandButton:"AllowanceManager-module__SDpZgW__expandButton",fadeIn:"AllowanceManager-module__SDpZgW__fadeIn",fadeOut:"AllowanceManager-module__SDpZgW__fadeOut",filterBtn:"AllowanceManager-module__SDpZgW__filterBtn",filterButtons:"AllowanceManager-module__SDpZgW__filterButtons",filterLabel:"AllowanceManager-module__SDpZgW__filterLabel",filterSection:"AllowanceManager-module__SDpZgW__filterSection",formActions:"AllowanceManager-module__SDpZgW__formActions",formCard:"AllowanceManager-module__SDpZgW__formCard",formGrid:"AllowanceManager-module__SDpZgW__formGrid",formGroup:"AllowanceManager-module__SDpZgW__formGroup",header:"AllowanceManager-module__SDpZgW__header",highlight:"AllowanceManager-module__SDpZgW__highlight",input:"AllowanceManager-module__SDpZgW__input",label:"AllowanceManager-module__SDpZgW__label",loading:"AllowanceManager-module__SDpZgW__loading",modal:"AllowanceManager-module__SDpZgW__modal",modalHeader:"AllowanceManager-module__SDpZgW__modalHeader",modalOverlay:"AllowanceManager-module__SDpZgW__modalOverlay",modalTitle:"AllowanceManager-module__SDpZgW__modalTitle",monthPicker:"AllowanceManager-module__SDpZgW__monthPicker",readOnlyField:"AllowanceManager-module__SDpZgW__readOnlyField",recordActions:"AllowanceManager-module__SDpZgW__recordActions",recordCard:"AllowanceManager-module__SDpZgW__recordCard",recordDate:"AllowanceManager-module__SDpZgW__recordDate",recordGrid:"AllowanceManager-module__SDpZgW__recordGrid",recordHeader:"AllowanceManager-module__SDpZgW__recordHeader",recordItem:"AllowanceManager-module__SDpZgW__recordItem",recordLabel:"AllowanceManager-module__SDpZgW__recordLabel",recordNote:"AllowanceManager-module__SDpZgW__recordNote",recordValue:"AllowanceManager-module__SDpZgW__recordValue",recordsList:"AllowanceManager-module__SDpZgW__recordsList",select:"AllowanceManager-module__SDpZgW__select",slideInUp:"AllowanceManager-module__SDpZgW__slideInUp",slideUp:"AllowanceManager-module__SDpZgW__slideUp",sourceBadge:"AllowanceManager-module__SDpZgW__sourceBadge",statsGrid:"AllowanceManager-module__SDpZgW__statsGrid",success:"AllowanceManager-module__SDpZgW__success",textarea:"AllowanceManager-module__SDpZgW__textarea",title:"AllowanceManager-module__SDpZgW__title",toast:"AllowanceManager-module__SDpZgW__toast",toastIcon:"AllowanceManager-module__SDpZgW__toastIcon",toastMessage:"AllowanceManager-module__SDpZgW__toastMessage"})},89672,e=>{"use strict";var a=e.i(43476),l=e.i(71645),t=e.i(2502),n=e.i(89598),o=e.i(74777),r=e.i(93716);let s={ç”Ÿæ´»è²»åŒ¯æ¬¾:{icon:"ğŸ“",color:"var(--color-primary)"},æ‰“å·¥æ”¶å…¥:{icon:"ğŸ’¼",color:"var(--color-accent)"},çå­¸é‡‘:{icon:"ğŸ†",color:"var(--color-highlight)"},é€€è²»:{icon:"ğŸ’¸",color:"var(--muted)"},å…¶ä»–:{icon:"ğŸ“¦",color:"var(--muted-dark)"}},c=({type:e})=>{let l=s[e]||s["å…¶ä»–"];return(0,a.jsxs)("div",{className:r.default.sourceBadge,style:{borderColor:l.color,color:l.color},children:[(0,a.jsx)("span",{children:l.icon}),(0,a.jsx)("span",{children:e})]})};function d(){let e,s,d,{records:i,sourceTypes:u,loading:m,canEdit:g,addRecord:p,updateRecord:_,deleteRecord:f}=(0,t.useAllowanceData)(),[h,x]=(0,l.useState)({date:new Date().toISOString().split("T")[0],amount:0,totalBalance:0,xiaoBalance:0,sourceType:u[0]||"ç”Ÿæ´»è²»åŒ¯æ¬¾",note:""}),[b,v]=(0,l.useState)(null),[S,j]=(0,l.useState)(!1),[y,N]=(0,l.useState)(!1),[w,D]=(0,l.useState)((s=(e=new Date).getFullYear(),d=e.getMonth()+1,`${s}-${String(d).padStart(2,"0")}`)),[B,A]=(0,l.useState)(""),[C,M]=(0,l.useState)(!1),[W,Z]=(0,l.useState)(""),$=(0,l.useMemo)(()=>{let e=new Date,a=e.getFullYear(),l=e.getMonth()+1,t=`${a}-${String(l).padStart(2,"0")}`,n=new Date(e.getFullYear(),e.getMonth()-1,1),o=n.getFullYear(),r=n.getMonth()+1;return[{label:"å…¨éƒ¨",value:""},{label:"æœ¬æœˆ",value:t},{label:"ä¸Šæœˆ",value:`${o}-${String(r).padStart(2,"0")}`}]},[]),T=(0,l.useMemo)(()=>w?i.filter(e=>e.date.startsWith(w)):i,[i,w]),[G,L]=(0,l.useState)(!1),I=G?T:T.slice(0,3),k=T.length>3,O=(0,l.useMemo)(()=>({totalDeposit:T.reduce((e,a)=>e+a.amount,0),recordCount:T.length,currentBookBalance:i[0]?.totalBalance||0,currentXiaoBalance:i[0]?.xiaoBalance||0}),[T,i]),P=(0,l.useMemo)(()=>{if(!w)return null;let[e,a]=w.split("-").map(Number),l=`${1===a?e-1:e}-${String(1===a?12:a-1).padStart(2,"0")}`,t=i.filter(e=>e.date.startsWith(l));return{totalDeposit:t.reduce((e,a)=>e+a.amount,0),recordCount:t.length}},[i,w]),F=(0,l.useMemo)(()=>{if(!P||0===P.totalDeposit)return null;let e=O.totalDeposit,a=P.totalDeposit,l=(e-a)/a*100;return{percent:l,isIncrease:l>0,arrow:l>0?"â†—ï¸":l<0?"â†˜ï¸":"â†’"}},[O.totalDeposit,P]),E=(0,l.useMemo)(()=>0===i.length?0:i[0].xiaoBalance,[i]),z=(0,l.useMemo)(()=>"ç”Ÿæ´»è²»åŒ¯æ¬¾"===h.sourceType,[h.sourceType]),H=(0,l.useMemo)(()=>z?(0,n.calculateKongBalance)(h.totalBalance,h.xiaoBalance):0,[z,h.totalBalance,h.xiaoBalance]),R=(0,l.useMemo)(()=>!!b&&"ç”Ÿæ´»è²»åŒ¯æ¬¾"===b.sourceType,[b]);(0,l.useEffect)(()=>{!m&&i.length>0&&0===h.amount&&"ç”Ÿæ´»è²»åŒ¯æ¬¾"===h.sourceType&&0===h.xiaoBalance&&x(e=>({...e,xiaoBalance:i[0].xiaoBalance}))},[m,i.length]);let V=(0,l.useMemo)(()=>b&&R?(0,n.calculateKongBalance)(b.totalBalance,b.xiaoBalance):0,[b,R]),X=e=>e.date?e.amount<=0?"åŒ¯å…¥é‡‘é¡å¿…é ˆå¤§æ–¼ 0":e.totalBalance<0?"å¸³ç°¿é¤˜é¡ä¸å¯ç‚ºè² æ•¸":e.xiaoBalance<0?"å°å‘†é¤˜é¡ä¸å¯ç‚ºè² æ•¸":e.xiaoBalance>e.totalBalance?"å°å‘†é¤˜é¡ä¸å¯å¤§æ–¼å¸³ç°¿é¤˜é¡":e.sourceType?null:"è«‹é¸æ“‡ä¾†æºé¡å‹":"è«‹é¸æ“‡åŒ¯å…¥æ—¥æœŸ",U=async()=>{let e=X(h);if(e)return void alert(e);let a={...h,id:(0,n.generateAllowanceId)(),timestamp:Date.now()};await p(a);let l=u[0]||"ç”Ÿæ´»è²»åŒ¯æ¬¾",t="ç”Ÿæ´»è²»åŒ¯æ¬¾"===l;x({date:new Date().toISOString().split("T")[0],amount:0,totalBalance:0,xiaoBalance:t?a.xiaoBalance:0,sourceType:l,note:""}),N(!1),J("âœ… è¨˜éŒ„å·²æ–°å¢")},K=async()=>{if(!b)return;let e=X(b);e?alert(e):(await _(b.id,b),j(!1),v(null),J("âœ… è¨˜éŒ„å·²æ›´æ–°"))},Y=async e=>{confirm("ç¢ºå®šè¦åˆªé™¤æ­¤è¨˜éŒ„å—ï¼Ÿ")&&(await f(e),J("ğŸ—‘ï¸ è¨˜éŒ„å·²åˆªé™¤"))},q=async e=>{let a=(0,n.generateCopyText)(e);try{await navigator.clipboard.writeText(a),J("ğŸ“‹ å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿")}catch(e){alert(`è¤‡è£½å…§å®¹ï¼š

${a}`)}},J=e=>{Z(e),M(!0),setTimeout(()=>M(!1),3e3)};return m?(0,a.jsx)("div",{className:r.default.container,children:(0,a.jsx)("div",{className:r.default.loading,children:"è¼‰å…¥ä¸­..."})}):(0,a.jsxs)("div",{className:r.default.container,children:[(0,a.jsxs)("div",{className:r.default.header,children:[(0,a.jsx)("h1",{className:r.default.title,children:"ğŸ’° ç”Ÿæ´»è²»è¨˜éŒ„"}),g&&(0,a.jsx)("button",{className:`${r.default.btn} ${r.default.btnPrimary} ${r.default.addButton}`,onClick:()=>{let e=u[0]||"ç”Ÿæ´»è²»åŒ¯æ¬¾",a="ç”Ÿæ´»è²»åŒ¯æ¬¾"===e;x({date:new Date().toISOString().split("T")[0],amount:0,totalBalance:0,xiaoBalance:a&&i.length>0?i[0].xiaoBalance:0,sourceType:e,note:""}),N(!0)},children:"â• æ–°å¢è¨˜éŒ„"})]}),(0,a.jsxs)("div",{className:`glass ${r.default.filterSection}`,children:[(0,a.jsx)("div",{className:r.default.filterLabel,children:"ç¯©é¸æœˆä»½"}),(0,a.jsxs)("div",{className:r.default.filterButtons,children:[$.map(e=>(0,a.jsx)("button",{className:`${r.default.filterBtn} ${w===e.value&&!B?r.default.active:""}`,onClick:()=>{D(e.value),A("")},children:e.label},e.value)),(0,a.jsx)("input",{type:"month",className:r.default.monthPicker,value:B,onChange:e=>{var a;A(a=e.target.value),a&&D(a)},placeholder:"é¸æ“‡æœˆä»½"})]})]}),T.length>0&&(0,a.jsxs)("div",{className:r.default.statsGrid,children:[(0,a.jsx)(o.StatCard,{icon:(0,a.jsx)("span",{style:{fontSize:"2rem"},children:"ğŸ’°"}),label:"æœ¬æœˆç´¯è¨ˆ",value:`${O.totalDeposit.toLocaleString()}`,subtext:F?`${F.arrow} ${Math.abs(F.percent).toFixed(1)}% vs ä¸Šæœˆ`:`å…± ${O.recordCount} ç­†`,color:"var(--color-primary)"}),(0,a.jsx)(o.StatCard,{icon:(0,a.jsx)("span",{style:{fontSize:"2rem"},children:"ğŸ’³"}),label:"å¸³ç°¿é¤˜é¡",value:`${O.currentBookBalance.toLocaleString()}`,subtext:"ç•¶å‰ç¸½é¡",color:"var(--color-accent)"}),(0,a.jsx)(o.StatCard,{icon:(0,a.jsx)("span",{style:{fontSize:"2rem"},children:"ğŸ¦"}),label:"å°å‘†é¤˜é¡",value:`${O.currentXiaoBalance.toLocaleString()}`,subtext:"å¯ç”¨é‡‘é¡",color:"var(--color-highlight)"})]}),(0,a.jsx)("div",{className:r.default.recordsList,children:0===T.length?(0,a.jsx)("div",{className:"glass card",children:(0,a.jsxs)("div",{className:r.default.emptyState,children:[(0,a.jsx)("div",{className:r.default.emptyStateIcon,children:"ğŸ“­"}),(0,a.jsx)("div",{className:r.default.emptyStateTitle,children:"å°šç„¡è¨˜éŒ„"}),(0,a.jsx)("div",{className:r.default.emptyStateSubtitle,children:w?"æ­¤æœˆä»½æ²’æœ‰ä»»ä½•è¨˜éŒ„":"é–‹å§‹æ–°å¢ä½ çš„ç¬¬ä¸€ç­†ç”Ÿæ´»è²»è¨˜éŒ„å§"})]})}):(0,a.jsxs)(a.Fragment,{children:[I.map((e,l)=>{let t=(0,n.calculateKongBalance)(e.totalBalance,e.xiaoBalance),o="ç”Ÿæ´»è²»åŒ¯æ¬¾"===e.sourceType;return(0,a.jsxs)("div",{className:`glass ${r.default.recordCard}`,style:{animationDelay:`${.05*l}s`},children:[(0,a.jsx)(c,{type:e.sourceType}),(0,a.jsxs)("div",{className:r.default.recordHeader,children:[(0,a.jsx)("div",{className:r.default.recordDate,children:(0,n.formatDateForCopy)(e.date)}),(0,a.jsx)("button",{className:r.default.copyButton,onClick:()=>q(e),title:"è¤‡è£½æ­¤è¨˜éŒ„",children:"ğŸ“‹ è¤‡è£½"})]}),(0,a.jsxs)("div",{className:r.default.amountSection,children:[(0,a.jsx)("div",{className:r.default.amountLabel,children:"åŒ¯å…¥é‡‘é¡"}),(0,a.jsxs)("div",{className:r.default.amountValue,children:["+",e.amount.toLocaleString()," å…ƒ"]})]}),(0,a.jsxs)("div",{className:r.default.balanceGrid,children:[(0,a.jsxs)("div",{className:r.default.balanceItem,children:[(0,a.jsx)("div",{className:r.default.balanceLabel,children:"å¸³ç°¿é¤˜é¡"}),(0,a.jsxs)("div",{className:r.default.balanceValue,children:[e.totalBalance.toLocaleString()," å…ƒ"]})]}),(0,a.jsxs)("div",{className:r.default.balanceItem,children:[(0,a.jsx)("div",{className:r.default.balanceLabel,children:"å°å‘†é¤˜é¡"}),(0,a.jsxs)("div",{className:r.default.balanceValue,children:[e.xiaoBalance.toLocaleString()," å…ƒ"]})]}),o&&(0,a.jsxs)("div",{className:r.default.balanceItem,children:[(0,a.jsx)("div",{className:r.default.balanceLabel,children:"å­”å‘†é¤˜é¡"}),(0,a.jsxs)("div",{className:r.default.balanceValue,children:[t.toLocaleString()," å…ƒ"]})]})]}),e.note&&(0,a.jsxs)("div",{className:r.default.recordNote,children:[(0,a.jsx)("strong",{children:"å‚™è¨»ï¼š"})," ",e.note]}),g&&(0,a.jsxs)("div",{className:r.default.recordActions,children:[(0,a.jsx)("button",{className:r.default.btnEdit,onClick:()=>{v({...e}),j(!0)},children:"ç·¨è¼¯"}),(0,a.jsx)("button",{className:r.default.btnDelete,onClick:()=>Y(e.id),children:"åˆªé™¤"})]})]},e.id)}),k&&!G&&(0,a.jsxs)("button",{className:`${r.default.btn} ${r.default.btnSecondary} ${r.default.expandButton}`,onClick:()=>L(!0),children:["æŸ¥çœ‹å…¨éƒ¨ (å…± ",T.length," ç­†)"]}),G&&(0,a.jsx)("button",{className:`${r.default.btn} ${r.default.btnSecondary} ${r.default.expandButton}`,onClick:()=>L(!1),children:"æ”¶èµ·è¨˜éŒ„"})]})}),S&&b&&(0,a.jsx)("div",{className:r.default.modalOverlay,onClick:()=>j(!1),children:(0,a.jsxs)("div",{className:`glass ${r.default.modal}`,onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:r.default.modalHeader,children:[(0,a.jsx)("h2",{className:r.default.modalTitle,children:"ç·¨è¼¯è¨˜éŒ„"}),(0,a.jsx)("button",{className:r.default.closeButton,onClick:()=>j(!1),children:"âœ•"})]}),(0,a.jsxs)("div",{className:r.default.formGrid,children:[(0,a.jsxs)("div",{className:r.default.formGroup,children:[(0,a.jsx)("label",{className:r.default.label,children:"åŒ¯å…¥æ—¥æœŸ *"}),(0,a.jsx)("input",{type:"date",className:r.default.input,value:b.date,onChange:e=>v({...b,date:e.target.value})})]}),(0,a.jsxs)("div",{className:r.default.formGroup,children:[(0,a.jsx)("label",{className:r.default.label,children:"åŒ¯å…¥é‡‘é¡ (å…ƒ) *"}),(0,a.jsx)("input",{type:"number",className:r.default.input,value:b.amount,onChange:e=>v({...b,amount:Number(e.target.value)})})]}),(0,a.jsxs)("div",{className:r.default.formGroup,children:[(0,a.jsx)("label",{className:r.default.label,children:"å¸³ç°¿é¤˜é¡ (å…ƒ) *"}),(0,a.jsx)("input",{type:"number",className:r.default.input,value:b.totalBalance,onChange:e=>v({...b,totalBalance:Number(e.target.value)})})]}),(0,a.jsxs)("div",{className:r.default.formGroup,children:[(0,a.jsx)("label",{className:r.default.label,children:"å°å‘†é¤˜é¡ (å…ƒ) *"}),(0,a.jsx)("input",{type:"number",className:r.default.input,value:b.xiaoBalance,onChange:e=>v({...b,xiaoBalance:Number(e.target.value)})})]}),(0,a.jsxs)("div",{className:r.default.formGroup,children:[(0,a.jsx)("label",{className:r.default.label,children:"å­”å‘†é¤˜é¡ (å…ƒ)"}),(0,a.jsx)("input",{type:"text",className:`${r.default.input} ${r.default.readOnlyField}`,value:V.toLocaleString(),readOnly:!0,disabled:!0})]}),(0,a.jsxs)("div",{className:r.default.formGroup,children:[(0,a.jsx)("label",{className:r.default.label,children:"ä¾†æºé¡å‹ *"}),(0,a.jsx)("select",{className:r.default.select,value:b.sourceType,onChange:e=>v({...b,sourceType:e.target.value}),children:u.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:r.default.formGroup,children:[(0,a.jsx)("label",{className:r.default.label,children:"å‚™è¨»"}),(0,a.jsx)("textarea",{className:r.default.textarea,value:b.note||"",onChange:e=>v({...b,note:e.target.value})})]}),(0,a.jsxs)("div",{className:r.default.formActions,children:[(0,a.jsx)("button",{className:`${r.default.btn} ${r.default.btnSecondary}`,onClick:()=>j(!1),children:"å–æ¶ˆ"}),(0,a.jsx)("button",{className:`${r.default.btn} ${r.default.btnPrimary}`,onClick:K,children:"å„²å­˜è®Šæ›´"})]})]})}),y&&(0,a.jsx)("div",{className:r.default.modalOverlay,onClick:()=>N(!1),children:(0,a.jsxs)("div",{className:`glass ${r.default.modal}`,onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:r.default.modalHeader,children:[(0,a.jsx)("h2",{className:r.default.modalTitle,children:"æ–°å¢è¨˜éŒ„"}),(0,a.jsx)("button",{className:r.default.closeButton,onClick:()=>N(!1),children:"âœ•"})]}),(0,a.jsxs)("div",{className:r.default.formGrid,children:[(0,a.jsxs)("div",{className:r.default.formGroup,children:[(0,a.jsx)("label",{className:r.default.label,children:"åŒ¯å…¥æ—¥æœŸ *"}),(0,a.jsx)("input",{type:"date",className:r.default.input,value:h.date,onChange:e=>x({...h,date:e.target.value})})]}),(0,a.jsxs)("div",{className:r.default.formGroup,children:[(0,a.jsx)("label",{className:r.default.label,children:"åŒ¯å…¥é‡‘é¡ (å…ƒ) *"}),(0,a.jsx)("input",{type:"number",className:r.default.input,value:h.amount||"",onChange:e=>(e=>{if("ç”Ÿæ´»è²»åŒ¯æ¬¾"===h.sourceType)x(a=>({...a,amount:e}));else{let a=E+e;x(l=>({...l,amount:e,xiaoBalance:a}))}})(Number(e.target.value)),placeholder:"0"})]}),(0,a.jsxs)("div",{className:r.default.formGroup,children:[(0,a.jsx)("label",{className:r.default.label,children:"å¸³ç°¿é¤˜é¡ (å…ƒ) *"}),(0,a.jsx)("input",{type:"number",className:r.default.input,value:h.totalBalance||"",onChange:e=>x({...h,totalBalance:Number(e.target.value)}),placeholder:"0"})]}),(0,a.jsxs)("div",{className:r.default.formGroup,children:[(0,a.jsxs)("label",{className:r.default.label,children:["å°å‘†é¤˜é¡ (å…ƒ) *",!z&&(0,a.jsx)("span",{className:r.default.autoCalcHint,children:"ï¼ˆè‡ªå‹•è¨ˆç®—ï¼‰"})]}),(0,a.jsx)("input",{type:"number",className:`${r.default.input} ${!z?r.default.readOnlyField:""}`,value:h.xiaoBalance||"",onChange:e=>x({...h,xiaoBalance:Number(e.target.value)}),disabled:!z,readOnly:!z,placeholder:"0"})]}),z&&(0,a.jsxs)("div",{className:r.default.formGroup,children:[(0,a.jsx)("label",{className:r.default.label,children:"å­”å‘†é¤˜é¡ (å…ƒ)"}),(0,a.jsx)("input",{type:"text",className:`${r.default.input} ${r.default.readOnlyField}`,value:H.toLocaleString(),readOnly:!0,disabled:!0})]}),(0,a.jsxs)("div",{className:r.default.formGroup,children:[(0,a.jsx)("label",{className:r.default.label,children:"ä¾†æºé¡å‹ *"}),(0,a.jsx)("select",{className:r.default.select,value:h.sourceType,onChange:e=>(e=>{if("ç”Ÿæ´»è²»åŒ¯æ¬¾"===e)x(a=>({...a,sourceType:e,xiaoBalance:E}));else{let a=E+h.amount;x(l=>({...l,sourceType:e,xiaoBalance:a}))}})(e.target.value),children:u.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:r.default.formGroup,style:{gridColumn:"1 / -1",marginTop:"var(--spacing-md)"},children:[(0,a.jsx)("label",{className:r.default.label,children:"å‚™è¨»"}),(0,a.jsx)("textarea",{className:r.default.textarea,value:h.note||"",onChange:e=>x({...h,note:e.target.value}),placeholder:"é¸å¡«"})]}),(0,a.jsxs)("div",{className:r.default.modalActions,children:[(0,a.jsx)("button",{className:`${r.default.btn} ${r.default.btnSecondary}`,onClick:()=>N(!1),children:"å–æ¶ˆ"}),(0,a.jsx)("button",{className:`${r.default.btn} ${r.default.btnPrimary}`,onClick:U,children:"ç¢ºèªæ–°å¢"})]})]})}),C&&(0,a.jsx)("div",{className:`${r.default.toast} ${r.default.success}`,children:(0,a.jsx)("div",{className:r.default.toastMessage,children:W})})]})}var i=e.i(32341),u=e.i(34759);function m(){let{user:e,loading:l}=(0,i.useAuth)();return l?(0,a.jsx)("div",{style:{padding:"2rem",textAlign:"center"},children:"è¼‰å…¥ä¸­..."}):e?(0,a.jsx)(d,{}):(0,a.jsx)(u.default,{})}e.s(["default",()=>m],89672)}]);