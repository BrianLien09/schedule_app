(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,93475,19119,e=>{"use strict";var t=e.i(71645),a=e.i(32341);let i=[{id:"mon-1",name:"職涯分析與規劃",day:1,startTime:"08:10",endTime:"10:00",location:"博愛CB105D",color:"#fca5a5"},{id:"mon-2",name:"國文(II)：語文表達",day:1,startTime:"10:10",endTime:"12:00",location:"博愛C306",color:"#fda4af"},{id:"mon-3",name:"數位電子學",day:1,startTime:"13:10",endTime:"16:00",location:"博愛G313",color:"var(--color-primary)"},{id:"tue-1",name:"網際網路概論",day:2,startTime:"08:10",endTime:"10:00",location:"博愛G512電腦教室",color:"#fdba74"},{id:"tue-2",name:"大學生活學習與輔導",day:2,startTime:"13:10",endTime:"15:00",location:"博愛G313",color:"var(--color-highlight)"},{id:"wed-1",name:"英文(II)",day:3,startTime:"08:10",endTime:"10:00",location:"博愛C608",color:"#86efac"},{id:"wed-2",name:"羽球",day:3,startTime:"10:10",endTime:"12:00",location:"博愛公誠樓籃球場",color:"#bef264"},{id:"wed-3",name:"資料結構",day:3,startTime:"15:10",endTime:"18:00",location:"博愛G513電腦教室",color:"var(--color-secondary)"},{id:"fri-1",name:"民歌與吉他",day:5,startTime:"08:10",endTime:"10:00",location:"博愛M304",color:"#93c5fd"},{id:"fri-2",name:"Python資料視覺化",day:5,startTime:"10:10",endTime:"12:00",location:"博愛G521電腦教室",color:"#c4b5fd"},{id:"fri-3",name:"C程式設計",day:5,startTime:"13:10",endTime:"16:00",location:"博愛G512電腦教室",color:"#a78bfa"}],r=[{id:"aut-1",date:"2026-01-11",startTime:"09:00",endTime:"18:00",note:"秋季班"},{id:"aut-2",date:"2026-01-17",startTime:"09:00",endTime:"18:00",note:"秋季班"},{id:"aut-3",date:"2026-01-18",startTime:"09:00",endTime:"18:00",note:"秋季班"},{id:"win-1",date:"2026-01-27",startTime:"09:00",endTime:"18:00",note:"冬令營助教"},{id:"win-2",date:"2026-01-29",startTime:"09:00",endTime:"18:00",note:"冬令營助教"},{id:"win-3",date:"2026-02-02",startTime:"09:00",endTime:"18:00",note:"冬令營助教"},{id:"win-4",date:"2026-02-04",startTime:"09:00",endTime:"18:00",note:"冬令營助教"},{id:"win-5",date:"2026-02-05",startTime:"09:00",endTime:"18:00",note:"冬令營助教"},{id:"win-6",date:"2026-02-06",startTime:"09:00",endTime:"18:00",note:"冬令營助教"},{id:"win-7",date:"2026-02-09",startTime:"09:00",endTime:"18:00",note:"冬令營助教"},{id:"win-8",date:"2026-02-10",startTime:"09:00",endTime:"18:00",note:"冬令營助教"},{id:"win-9",date:"2026-02-11",startTime:"09:00",endTime:"18:00",note:"冬令營助教"},{id:"win-10",date:"2026-02-13",startTime:"09:00",endTime:"18:00",note:"冬令營助教"}],d=[{id:"sel-1",title:"志願序結果查詢 & 本班選課",date:"2026-01-05",description:"09:00 查詢結果 / 19:00 開始選課",type:"deadline"},{id:"sel-2",title:"本系選課 (含輔雙)",date:"2026-01-06",description:"19:00 開始",type:"deadline"},{id:"sel-3",title:"跨系/跨班選課",date:"2026-01-08",description:"19:00 開始",type:"deadline"},{id:"sel-4",title:"全校網路加退選",date:"2026-02-23",description:"上午 10:00 開始",type:"deadline"},{id:"sel-5",title:"人工加退選",date:"2026-03-02",description:"上午 09:00 開始",type:"personal"}];e.i(36180);var s=e.i(98925),l=e.i(59141);function n(e,t){return(0,s.collection)(l.db,"users",e,t)}async function o(e,t,a,i){let r=(0,s.doc)(l.db,"users",e,t,a);await (0,s.setDoc)(r,{...i,updatedAt:new Date().toISOString()})}async function c(e,t,...a){let i=n(e,t),r=a.length>0?(0,s.query)(i,...a):i;return(await (0,s.getDocs)(r)).docs.map(e=>({id:e.id,...e.data()}))}async function u(e,t,a,i){let r=(0,s.doc)(l.db,"users",e,t,a);await (0,s.updateDoc)(r,{...i,updatedAt:new Date().toISOString()})}async function m(e,t,a){let i=(0,s.doc)(l.db,"users",e,t,a);await (0,s.deleteDoc)(i)}function f(e,t,a,...i){let r=n(e,t),d=i.length>0?(0,s.query)(r,...i):r;return(0,s.onSnapshot)(d,e=>{a(e.docs.map(e=>({id:e.id,...e.data()})))})}async function h(e,t,a){let i=a.map(a=>{let{id:i,...r}=a;return o(e,t,i,r)});await Promise.all(i)}function g(){let{user:e}=(0,a.useAuth)(),[s,l]=(0,t.useState)([]),[n,g]=(0,t.useState)([]),[_,y]=(0,t.useState)([]),[w,S]=(0,t.useState)(!0),p=async e=>{try{if(localStorage.getItem("firestore_migrated"))return;let t=localStorage.getItem("schedule_courses"),a=localStorage.getItem("schedule_workShifts"),i=localStorage.getItem("schedule_events");if(t){let a=JSON.parse(t);await h(e,"courses",a)}if(a){let t=JSON.parse(a);await h(e,"workShifts",t)}if(i){let t=JSON.parse(i);await h(e,"events",t)}localStorage.setItem("firestore_migrated","true"),console.log("✅ 資料已成功遷移至 Firestore")}catch(e){console.error("❌ 資料遷移失敗:",e)}},T=async e=>{try{let t=await c(e,"courses"),a=await c(e,"workShifts"),s=await c(e,"events");0===t.length&&await h(e,"courses",i),0===a.length&&await h(e,"workShifts",r),0===s.length&&await h(e,"events",d)}catch(e){console.error("❌ 初始化預設資料失敗:",e)}};(0,t.useEffect)(()=>{if(!e){S(!0);let e=localStorage.getItem("schedule_courses"),t=localStorage.getItem("schedule_workShifts"),a=localStorage.getItem("schedule_events");l(e?JSON.parse(e):i),g(t?JSON.parse(t):r),y(a?JSON.parse(a):d),S(!1);return}let t=e.uid;S(!0),p(t).then(()=>T(t)).then(()=>{S(!1)});let a=f(t,"courses",e=>l(e)),s=f(t,"workShifts",e=>g(e)),n=f(t,"events",e=>y(e));return()=>{a(),s(),n()}},[e]);let N=async t=>{if(!e){let e=[...s,t];l(e),localStorage.setItem("schedule_courses",JSON.stringify(e));return}await o(e.uid,"courses",t.id,t)},v=async(t,a)=>{if(!e){let e=s.map(e=>e.id===t?{...e,...a}:e);l(e),localStorage.setItem("schedule_courses",JSON.stringify(e));return}await u(e.uid,"courses",t,a)},C=async t=>{if(!e){let e=s.filter(e=>e.id!==t);l(e),localStorage.setItem("schedule_courses",JSON.stringify(e));return}await m(e.uid,"courses",t)},b=async t=>{if(!e){let e=[...n,t];g(e),localStorage.setItem("schedule_workShifts",JSON.stringify(e));return}await o(e.uid,"workShifts",t.id,t)},M=async(t,a)=>{if(!e){let e=n.map(e=>e.id===t?{...e,...a}:e);g(e),localStorage.setItem("schedule_workShifts",JSON.stringify(e));return}await u(e.uid,"workShifts",t,a)},D=async t=>{if(!e){let e=n.filter(e=>e.id!==t);g(e),localStorage.setItem("schedule_workShifts",JSON.stringify(e));return}await m(e.uid,"workShifts",t)},I=async t=>{if(!e){let e=[..._,t];y(e),localStorage.setItem("schedule_events",JSON.stringify(e));return}await o(e.uid,"events",t.id,t)},k=async(t,a)=>{if(!e){let e=_.map(e=>e.id===t?{...e,...a}:e);y(e),localStorage.setItem("schedule_events",JSON.stringify(e));return}await u(e.uid,"events",t,a)},K=async t=>{if(!e){let e=_.filter(e=>e.id!==t);y(e),localStorage.setItem("schedule_events",JSON.stringify(e));return}await m(e.uid,"events",t)};return{courses:s,shifts:n,events:_,loading:w,addCourse:N,updateCourse:v,deleteCourse:C,addWorkShift:b,updateWorkShift:M,deleteWorkShift:D,addEvent:I,updateEvent:k,deleteEvent:K,resetToDefault:async()=>{if(!e){l(i),g(r),y(d),localStorage.setItem("schedule_courses",JSON.stringify(i)),localStorage.setItem("schedule_workShifts",JSON.stringify(r)),localStorage.setItem("schedule_events",JSON.stringify(d));return}await h(e.uid,"courses",i),await h(e.uid,"workShifts",r),await h(e.uid,"events",d)}}}e.s(["batchSetDocuments",()=>h,"deleteDocument",()=>m,"getDocuments",()=>c,"setDocument",()=>o,"subscribeToCollection",()=>f,"updateDocument",()=>u],19119),e.s(["useScheduleData",()=>g],93475)},21163,e=>{e.v({calendarContainer:"page-module__wKMnra__calendarContainer",dayCell:"page-module__wKMnra__dayCell",dayCellEmpty:"page-module__wKMnra__dayCellEmpty",dayCellWithShift:"page-module__wKMnra__dayCellWithShift",dayNumber:"page-module__wKMnra__dayNumber",dayNumberEmpty:"page-module__wKMnra__dayNumberEmpty",dayNumberWithShift:"page-module__wKMnra__dayNumberWithShift",daysGrid:"page-module__wKMnra__daysGrid",detailsSection:"page-module__wKMnra__detailsSection",emptyCell:"page-module__wKMnra__emptyCell",pageContainer:"page-module__wKMnra__pageContainer",sectionTitle:"page-module__wKMnra__sectionTitle",shiftBadge:"page-module__wKMnra__shiftBadge",shiftCard:"page-module__wKMnra__shiftCard",shiftCardNormal:"page-module__wKMnra__shiftCardNormal",shiftCardSelected:"page-module__wKMnra__shiftCardSelected",shiftDate:"page-module__wKMnra__shiftDate",shiftDetails:"page-module__wKMnra__shiftDetails",shiftName:"page-module__wKMnra__shiftName",shiftTime:"page-module__wKMnra__shiftTime",shiftsGrid:"page-module__wKMnra__shiftsGrid",weekdayLabel:"page-module__wKMnra__weekdayLabel",weekdaysGrid:"page-module__wKMnra__weekdaysGrid"})},45858,e=>{"use strict";var t=e.i(43476),a=e.i(71645),i=e.i(93475),r=e.i(21163);function d(){let{shifts:e}=(0,i.useScheduleData)(),{currentMonth:d,selectedDate:s,changeMonth:l,getDaysInMonth:n,getShiftsForDate:o,currentMonthShifts:c,handleDateClick:u}=function(e){let[t,i]=(0,a.useState)(new Date),[r,d]=(0,a.useState)(null),s=(0,a.useRef)(null),l=(0,a.useMemo)(()=>{let t=new Map;return e.forEach(e=>{t.has(e.date)||t.set(e.date,[]),t.get(e.date).push(e)}),t},[e]),n=(0,a.useMemo)(()=>e.filter(e=>{let a=new Date(e.date);return a.getMonth()===t.getMonth()&&a.getFullYear()===t.getFullYear()}).sort((e,t)=>e.date.localeCompare(t.date)),[t,e]);return(0,a.useEffect)(()=>{if(s.current){let e=document.querySelector(`[data-date="${s.current}"]`);e&&e.scrollIntoView({behavior:"smooth",block:"center"}),s.current=null}},[r]),{currentMonth:t,selectedDate:r,changeMonth:e=>{i(new Date(t.getFullYear(),t.getMonth()+e,1))},getDaysInMonth:e=>{let t=e.getFullYear(),a=e.getMonth(),i=new Date(t,a+1,0).getDate(),r=new Date(t,a,1).getDay();return{days:i,startDay:0===r?6:r-1}},getShiftsForDate:e=>{let a=t.getFullYear(),i=t.getMonth()+1,r=`${a}-${i.toString().padStart(2,"0")}-${e.toString().padStart(2,"0")}`;return l.get(r)||[]},currentMonthShifts:n,handleDateClick:e=>{let a=t.getFullYear(),i=t.getMonth()+1,r=`${a}-${i.toString().padStart(2,"0")}-${e.toString().padStart(2,"0")}`;d(r),s.current=r}}}(e),{days:m,startDay:f}=n(d);return(0,t.jsx)("div",{className:r.default.pageContainer,children:(0,t.jsx)("div",{className:`glass ${r.default.calendarContainer}`,children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"calendar-header",children:[(0,t.jsx)("button",{onClick:()=>l(-1),className:"btn",style:{background:"rgba(255,255,255,0.3)",color:"white"},children:"← 上個月"}),(0,t.jsxs)("h2",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:[d.getFullYear()," 年 ",d.getMonth()+1," 月"]}),(0,t.jsx)("button",{onClick:()=>l(1),className:"btn",style:{background:"rgba(255,255,255,0.3)",color:"white"},children:"下個月 →"})]}),(0,t.jsx)("div",{className:r.default.weekdaysGrid,children:["一","二","三","四","五","六","日"].map(e=>(0,t.jsx)("div",{className:r.default.weekdayLabel,children:e},e))}),(0,t.jsxs)("div",{className:r.default.daysGrid,children:[Array.from({length:f}).map((e,a)=>(0,t.jsx)("div",{className:r.default.emptyCell},`empty-${a}`)),Array.from({length:m}).map((e,a)=>{let i=a+1,d=o(i),s=d.length>0;return(0,t.jsxs)("div",{onClick:()=>s&&u(i),className:`${r.default.dayCell} ${s?r.default.dayCellWithShift:r.default.dayCellEmpty} ${s?"card":""}`,children:[(0,t.jsx)("div",{className:`${r.default.dayNumber} ${s?r.default.dayNumberWithShift:r.default.dayNumberEmpty}`,children:i}),d.map(e=>(0,t.jsx)("div",{className:r.default.shiftBadge,children:e.note||"打工"},e.id))]},i)})]}),(0,t.jsxs)("div",{className:r.default.detailsSection,children:[(0,t.jsx)("h3",{className:r.default.sectionTitle,children:"本月詳細列表"}),(0,t.jsx)("div",{className:r.default.shiftsGrid,children:c.map(e=>{let a=s===e.date;return(0,t.jsxs)("div",{"data-date":e.date,className:`${r.default.shiftCard} ${a?r.default.shiftCardSelected:r.default.shiftCardNormal}`,children:[(0,t.jsxs)("div",{className:r.default.shiftDate,children:[e.date.split("-")[2],"日"]}),(0,t.jsxs)("div",{className:r.default.shiftDetails,children:[(0,t.jsx)("div",{className:r.default.shiftName,children:e.note}),(0,t.jsxs)("div",{className:r.default.shiftTime,children:[e.startTime," - ",e.endTime]})]})]},e.id)})})]})]})})})}e.s(["default",()=>d],45858)}]);